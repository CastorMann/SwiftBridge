// Vulnerability utilities
// Extracted from Bridge.swift

import Foundation

public func nsvul(_ boardNumber: Int) -> Bool {
    let b = (boardNumber - 1) & 15
    return (b ^ (b >> 2)) & 1 == 1
}

public func ewvul(_ boardNumber: Int) -> Bool {
    let b = (boardNumber - 1) & 15
    return (b + (b >> 2)) & 2 == 2
}

public func vulnerability(_ boardNumber: Int) -> Direction {
    return (nsvul(boardNumber) ? DIRECTION_NORTH_SOUTH : DIRECTION_NONE) | (ewvul(boardNumber) ? DIRECTION_EAST_WEST : DIRECTION_NONE)
}

public func dealNumberFromDealerAndVulnerability(dealer: Direction, vul: Direction) -> Int {
    var d: Int = 0
    
    if dealer == DIRECTION_NORTH && vul == DIRECTION_NONE { d = 1 }
    if dealer == DIRECTION_EAST && vul == DIRECTION_NORTH_SOUTH { d = 2 }
    if dealer == DIRECTION_SOUTH && vul == DIRECTION_EAST_WEST { d = 3 }
    if dealer == DIRECTION_WEST && vul == DIRECTION_ALL { d = 4 }
    if dealer == DIRECTION_NORTH && vul == DIRECTION_NORTH_SOUTH { d = 5 }
    if dealer == DIRECTION_EAST && vul == DIRECTION_EAST_WEST { d = 6 }
    if dealer == DIRECTION_SOUTH && vul == DIRECTION_ALL { d = 7 }
    if dealer == DIRECTION_WEST && vul == DIRECTION_NONE { d = 8 }
    if dealer == DIRECTION_NORTH && vul == DIRECTION_EAST_WEST { d = 9 }
    if dealer == DIRECTION_EAST && vul == DIRECTION_ALL { d = 10 }
    if dealer == DIRECTION_SOUTH && vul == DIRECTION_NONE { d = 11 }
    if dealer == DIRECTION_WEST && vul == DIRECTION_NORTH_SOUTH { d = 12 }
    if dealer == DIRECTION_NORTH && vul == DIRECTION_ALL { d = 13 }
    if dealer == DIRECTION_EAST && vul == DIRECTION_NONE { d = 14 }
    if dealer == DIRECTION_SOUTH && vul == DIRECTION_NORTH_SOUTH { d = 15 }
    if dealer == DIRECTION_WEST && vul == DIRECTION_EAST_WEST { d = 16 }
    
    return d
}
